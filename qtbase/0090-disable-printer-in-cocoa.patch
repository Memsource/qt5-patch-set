From 9c40018d2d5effc1dd83d9a303e3ca501659ea25 Mon Sep 17 00:00:00 2001
From: "michal.lazo" <michal.lazo@memsource.com>
Date: Mon, 18 Jun 2018 17:39:27 +0200
Subject: [PATCH] disable printer in cocoa

---
 src/plugins/platforms/cocoa/cocoa.pro                | 2 +-
 src/plugins/platforms/cocoa/qcocoanativeinterface.mm | 2 ++
 src/plugins/platforms/cocoa/qcocoaprintdevice.h      | 2 ++
 src/plugins/platforms/cocoa/qcocoaprintersupport.h   | 2 ++
 src/plugins/platforms/cocoa/qpaintengine_mac.mm      | 2 ++
 5 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/src/plugins/platforms/cocoa/cocoa.pro b/src/plugins/platforms/cocoa/cocoa.pro
index 5a00e1b..7cb0c24 100644
--- a/src/plugins/platforms/cocoa/cocoa.pro
+++ b/src/plugins/platforms/cocoa/cocoa.pro
@@ -111,7 +111,7 @@ qtHaveModule(widgets) {
         HEADERS += qcocoafontdialoghelper.h
     }
 
-    QT += widgets-private printsupport-private
+    QT += widgets-private
 }
 
 OTHER_FILES += cocoa.json
diff --git a/src/plugins/platforms/cocoa/qcocoanativeinterface.mm b/src/plugins/platforms/cocoa/qcocoanativeinterface.mm
index 5504c24..05ae68a 100644
--- a/src/plugins/platforms/cocoa/qcocoanativeinterface.mm
+++ b/src/plugins/platforms/cocoa/qcocoanativeinterface.mm
@@ -62,8 +62,10 @@
 #ifndef QT_NO_WIDGETS
 #include "qcocoaprintersupport.h"
 #include "qprintengine_mac_p.h"
+#if !defined(QT_NO_PRINTER)
 #include <qpa/qplatformprintersupport.h>
 #endif
+#endif
 
 #include <QtGui/private/qcoregraphics_p.h>
 
diff --git a/src/plugins/platforms/cocoa/qcocoaprintdevice.h b/src/plugins/platforms/cocoa/qcocoaprintdevice.h
index c726cca..6f65b68 100644
--- a/src/plugins/platforms/cocoa/qcocoaprintdevice.h
+++ b/src/plugins/platforms/cocoa/qcocoaprintdevice.h
@@ -51,7 +51,9 @@
 // We mean it.
 //
 
+#ifndef QT_NO_PRINTER
 #include <qpa/qplatformprintdevice.h>
+#endif
 
 #ifndef QT_NO_PRINTER
 
diff --git a/src/plugins/platforms/cocoa/qcocoaprintersupport.h b/src/plugins/platforms/cocoa/qcocoaprintersupport.h
index a07bf0e..b22b24d 100644
--- a/src/plugins/platforms/cocoa/qcocoaprintersupport.h
+++ b/src/plugins/platforms/cocoa/qcocoaprintersupport.h
@@ -40,7 +40,9 @@
 #ifndef QCOCOAPRINTERSUPPORT_H
 #define QCOCOAPRINTERSUPPORT_H
 
+#ifndef QT_NO_PRINTER
 #include <qpa/qplatformprintersupport.h>
+#endif
 #ifndef QT_NO_PRINTER
 
 #include "qt_mac_p.h"
diff --git a/src/plugins/platforms/cocoa/qpaintengine_mac.mm b/src/plugins/platforms/cocoa/qpaintengine_mac.mm
index 7e241e3..5c1d3f8 100644
--- a/src/plugins/platforms/cocoa/qpaintengine_mac.mm
+++ b/src/plugins/platforms/cocoa/qpaintengine_mac.mm
@@ -45,7 +45,9 @@
 #include <qpainterpath.h>
 #include <qpixmapcache.h>
 #include <private/qpaintengine_raster_p.h>
+#if !defined(QT_NO_PRINTER)
 #include <qprinter.h>
+#endif
 #include <qstack.h>
 #include <qtextcodec.h>
 #include <qwidget.h>
-- 
2.9.2.windows.1

